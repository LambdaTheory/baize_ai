# Excel导出功能说明

## 功能概述

Excel导出功能允许将AI图片信息导出为Excel表格文件(.xlsx)，支持嵌入图片显示，方便数据管理和分享。

## 主要特性

### 1. 数据导出
- 导出所有图片记录的详细信息
- 包含文件名、提示词、模型参数等完整数据
- 支持LoRA信息格式化显示
- 自动处理标签和备注信息

### 2. 图片嵌入
- 可选择是否在Excel中嵌入图片
- 自动调整图片大小以适应表格
- 默认图片尺寸：150x150像素
- 支持PNG、JPG、JPEG、WEBP格式

### 3. 表格样式
- 专业的表格样式设计
- 彩色表头和边框
- 自动调整列宽
- 冻结首行便于浏览
- 文本自动换行

## 使用方法

### 1. 通过批量导出对话框
1. 在主界面选择需要导出的记录
2. 点击"批量导出"按钮
3. 选择"Excel - 表格格式（推荐，含图片）"
4. 选择输出文件夹
5. 点击"开始导出"

### 2. 导出选项
- **包含图片**：默认启用，将图片嵌入Excel文件
- **图片尺寸**：可通过代码调整最大尺寸
- **输出路径**：可自定义导出文件夹

## 表格结构

导出的Excel文件包含以下列：

| 列名 | 说明 |
|------|------|
| 图片 | 嵌入的缩略图（可选） |
| 文件名 | 原始图片文件名 |
| 自定义名称 | 用户设置的自定义名称 |
| 正向提示词 | AI生成的正向提示词 |
| 负向提示词 | AI生成的负向提示词 |
| 模型 | 使用的AI模型名称 |
| 采样器 | 采样器类型 |
| 采样步数 | 生成步数 |
| CFG缩放 | CFG Scale参数 |
| 种子 | 随机种子值 |
| LoRA信息 | LoRA模型及权重信息 |
| 标签 | 图片标签 |
| 备注 | 用户备注 |
| 创建时间 | 记录创建时间 |

## 技术实现

### 依赖库
- `openpyxl`：Excel文件操作
- `Pillow`：图片处理
- `PyQt5`：用户界面

### 核心模块
- `core/excel_exporter.py`：Excel导出器
- `ui/fluent_batch_export_dialog.py`：批量导出对话框

## 注意事项

1. **文件大小**：包含图片的Excel文件可能较大
2. **图片路径**：确保图片文件存在且可访问
3. **内存使用**：大量图片可能占用较多内存
4. **兼容性**：生成的Excel文件兼容Office 2010及以上版本

## 故障排除

### 常见问题

**Q: 导出失败，提示"Excel导出失败"**
A: 检查是否安装了openpyxl库：`pip install openpyxl>=3.0.0`

**Q: 图片无法显示**
A: 确认图片文件路径正确且文件存在

**Q: Excel文件过大**
A: 可以选择不包含图片或减少导出记录数量

**Q: 打开Excel文件很慢**
A: 这是正常现象，包含大量图片的文件需要更多加载时间

## 更新日志

### v1.0.0
- 初始版本发布
- 支持基本数据导出
- 支持图片嵌入
- 专业表格样式